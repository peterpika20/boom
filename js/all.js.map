{"version":3,"sources":["all.js"],"names":["height","width","arr","start","form","document","querySelector","addEventListener","e","degree","srcElement","defaultValue","boom","container","innerHTML","floor","i","arrIn","tr","createElement","appendChild","j","className","push","n","x","Math","random","y","classList","contains","add","play","cb","remove","window","setTimeout","alert","textContent"],"mappings":"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","file":"all.js","sourcesContent":["const height = 20; // 設定高度\r\nconst width = 20; // 設定寬度\r\nlet arr = []; // 設定儲存陣列\r\n\r\n// 遊戲開始\r\nstart(10);\r\n\r\n// 轉換難度\r\nconst form = document.querySelector('.form');\r\nform.addEventListener('change', function (e) {\r\n  let degree = e.srcElement.defaultValue;\r\n  switch (degree) {\r\n    case 'easy':\r\n      start(10);\r\n      break;\r\n    case 'medium':\r\n      start(50);\r\n      break;\r\n    case 'difficult':\r\n      start(100);\r\n      break;\n  }\r\n});\r\n\r\nfunction start (boom) {\r\n  const container = document.querySelector('.container');\r\n  container.innerHTML = '';\r\n  let floor = height * width;\r\n  for (let i = 0; i < height; i++) {\r\n    let arrIn = []; // 設定內存陣列 儲存二維陣列給一維用\r\n    let tr = document.createElement('tr');\r\n    container.appendChild(tr);\r\n    for (let j = 0; j < width; j++) {\n      let floor = document.createElement('td');\r\n      floor.className = 'floor hide';\r\n      arrIn.push(floor); // 把td加入陣列中\r\n      container.appendChild(floor);\n    }\r\n    arr[i] = arrIn; // 完整陣列\r\n  }\r\n  // 隨機加入炸彈 使用遞迴法\r\n  (function boom (n) {\r\n    if (n === 0) { return 1; };\r\n    let x = Math.floor(Math.random() * width);\r\n    let y = Math.floor(Math.random() * height);\r\n    // 判斷是否已經加入炸彈\r\n    if (!arr[x][y].classList.contains('boom')) {\r\n      arr[x][y].classList.add('boom');\r\n      return boom(n - 1);\r\n    }\r\n    return boom(n);\r\n  })(boom);\r\n\r\n  // 陣列加入監聽;\r\n\r\n  for (let i = 0; i < height; i++) {\r\n    for (let j = 0; j < width; j++) {\n      arr[i][j].addEventListener('click', function () { play(i, j); });\n    }\r\n  }\r\n\r\n  // 監聽的callback函數\r\n  function play (i, j) {\n    let n = 0;\r\n    for (let y = -1; y <= 1; y++) {\r\n      for (let x = -1; x <= 1; x++) {\r\n      // 判斷陣列是否超出範圍 超出就continue 之後判斷此點周圍炸彈 n+1\r\n        if (i - y < 0 || j - x < 0 || i - y > height - 1 || j - x > width - 1) { continue; } else if (arr[i - y][j - x].classList.contains('boom')) {\r\n          n += 1;\r\n          continue;\r\n        }\r\n      }\r\n    }\r\n    // 判斷踩到炸彈\r\n    if (arr[i][j].classList.contains('boom')) {\n      // 使用callback function 確保順序正確\n      (function (cb) {\n        arr[i][j].classList.remove('hide');\n        window.setTimeout(function () { cb(); }, 100);\n      })(function () { window.alert('boom'); return start(boom); });\n    }\r\n\r\n    // 判斷是否已經打開 不要讓程式一直run\r\n    if (!arr[i][j].classList.contains('hide')) {\r\n      return 1;\r\n    }\r\n    if (n !== 0) {\r\n      arr[i][j].textContent = n;\r\n      arr[i][j].classList.remove('hide');\r\n      floor -= 1;\r\n      if (floor === boom) { return window.alert('You,win'); }\r\n      return 1;\r\n    }\r\n\r\n    // 判斷邊界是否超出範圍\r\n    if (i === 0 || j === 0 || i === height - 1 || j === width - 1) {\r\n      arr[i][j].classList.remove('hide');\r\n      floor -= 1;\r\n      if (floor === boom) { return window.alert('You,win'); }\r\n      return 1;\r\n    }\r\n    // 用遞迴判斷8個方向\r\n    arr[i][j].classList.remove('hide');\r\n    floor -= 1;\r\n    if (floor === boom) { return window.alert('You,win'); }\r\n\r\n    return play(i - 1, j - 1) + play(i - 1, j) + play(i - 1, j + 1) + play(i + 1, j - 1) + play(i + 1, j) + play(i, j - 1) + play(i, j + 1) + play(i + 1, j + 1);\r\n  };\n}\r\n"]}